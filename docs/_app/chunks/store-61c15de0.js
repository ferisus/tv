import{D as c,_ as l,Y as m,Z as d}from"./vendor-699b6971.js";const C=c(""),b=c(!1),g=c([]),j=c({}),f=c([]);function $(n){B("q",n);const a=n.toLowerCase().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)||[],t=[];for(let o of a){let h="_key";o.includes(":")&&([h,o]=o.split(":"),o=o.replace(/\"/g,"")),h&&o&&t.push({field:h,value:o})}if(!t.length){b.set(!1),f.set(d(g));return}const r=d(g).filter(o=>{for(let h of t)if(!o._searchable[h.field]||o._searchable[h.field].indexOf(h.value)===-1)return!1;return!0});f.set(r),b.set(!0),console.log(".")}async function L(){let n=await fetch("https://iptv-org.github.io/api/countries.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>e.map(s=>(s.expanded=!1,s))).then(e=>l.keyBy(e,"code")).catch(console.error);j.set(n);let a=await fetch("https://iptv-org.github.io/api/regions.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>l.keyBy(e,"code")).catch(console.error),t=await fetch("https://iptv-org.github.io/api/subdivisions.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>l.keyBy(e,"code")).catch(console.error),r=await fetch("https://iptv-org.github.io/api/languages.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>l.keyBy(e,"code")).catch(console.error),o=await fetch("https://iptv-org.github.io/api/categories.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>l.keyBy(e,"id")).catch(console.error),h=await fetch("https://iptv-org.github.io/api/streams.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>l.groupBy(e,"channel")).catch(console.error),w=await fetch("https://iptv-org.github.io/api/guides.json").then(e=>e.json()).then(e=>e.length?e:[]).then(e=>l.groupBy(e,"channel")).catch(console.error),p=await fetch("https://iptv-org.github.io/api/channels.json").then(e=>e.json()).then(e=>e.map(s=>{s._raw=JSON.parse(JSON.stringify(s)),s._streams=h[s.id]||[],s._guides=w[s.id]||[];for(let y in s)switch(y){case"languages":s.languages=s.languages.map(i=>r[i]).filter(i=>i);break;case"broadcast_area":s.broadcast_area=s.broadcast_area.map(i=>{const[_,u]=i.split("/");switch(_){case"c":return n[u];case"r":return a[u];case"s":return t[u]}}).filter(i=>i);break;case"categories":s.categories=s.categories.map(i=>o[i]).filter(i=>i);break;case"country":s.country=n[s.country];break;case"subdivision":s.subdivision=t[s.subdivision];break}return s._searchable=k(s),s})).catch(e=>(console.error(e),[]));g.set(p),f.set(p)}function v(n){const a=n.native_name?m(n.native_name):null;return[n.id,n.name,n.native_name,a].map(t=>t||"").filter(t=>t).join("_").replace(/\s/g,"").toLowerCase()}function k(n){const a={};for(let t in n)t.startsWith("_")||n[t]===null||n[t]===void 0||(Array.isArray(n[t])?a[t]=n[t].map(r=>r.name?r.name.toLowerCase():null).filter(r=>r).join(","):typeof n[t]=="object"&&n[t].name?a[t]=n[t].name.toLowerCase():a[t]=n[t].toString().toLowerCase());return a._key=v(n),a}function B(n,a){if(window.history.pushState){let t=n&&a?`?${n}=${a}`:"";t=t.replace(/\+/g,"%2B");const r=`${window.location.protocol}//${window.location.host}${window.location.pathname}${t}`;window.history.pushState({path:r},"",r)}}export{L as a,j as c,f,b as h,C as q,$ as s};
